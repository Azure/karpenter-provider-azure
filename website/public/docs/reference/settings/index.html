<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.145.0">



<title>Settings | Karpenter for Azure</title>
<meta name="description" content="Configure Karpenter
">

<meta property="og:url" content="//localhost:1313/docs/reference/settings/">
  <meta property="og:site_name" content="Karpenter for Azure">
  <meta property="og:title" content="Settings">
  <meta property="og:description" content="Configure Karpenter">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="og:image" content="//localhost:1313/banner.png">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="//localhost:1313/banner.png">
  <meta name="twitter:title" content="Settings">
  <meta name="twitter:description" content="Configure Karpenter">






<link href="/scss/main.css" rel="stylesheet">


  </head>
  <body class="td-page">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 500 443" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M237.704918.0C314.662629.0 377.04918 62.3865513 377.04918 139.344262L377.049 336.352 442.622951 336.351852C474.31142 336.351852 5e2 362.040432 5e2 393.728901V443h-7.546066c-18.225271.0-33.094961-14.592764-33.437541-32.814815V401.960534L459.013099 401.553891C458.795948 388.160675 447.871194 377.37037 434.42623 377.37037H106.557377c-58.8500143.0-106.557377-47.707362-106.557377-106.557377L-100611761e-22 139.344262c0-76.9577107 62.3865513-139.344262 139.344262-139.344262zm-8.196721 41.0185185H147.540984L145.778863 41.0327942C87.7415928 41.97378 40.9836066 89.3143814 40.9836066 147.575896V270.778081L40.9923916 271.862464C41.5714598 307.577706 70.7041376 336.351852 106.557377 336.351852H270.491803c36.215394.0 65.573771-29.358377 65.573771-65.573771V147.575896L336.051298 145.813774C335.110312 87.7765047 287.769711 41.0185185 229.508197 41.0185185zM147.868852 106.648148C157.213115 106.648148 164.590164 114.277593 164.590164 123.875926v49.960555l56.803279-58.574444C228.770492 108.370926 238.852459 107.878704 245.983607 114.523704V114.769815C252.868852 121.168704 252.377049 131.751481 244.754098 138.642593l-42.04918 43.315555 48.934426 69.895556C257.540984 260.467593 255.819672 271.296481 247.95082 276.464815 239.344262 281.387037 229.508197 278.679815 223.606557 270.065926l-44.016393-64.481111-15 15.751111v40.362222c0 9.84444500000001-7.377049 17.227778-16.721312 17.227778C138.52459 278.925926 131.147541 271.542593 131.147541 261.698148V123.875926c0-9.59833300000001 7.377049-17.227778 16.721311-17.227778z" id="white_square_logo" fill="#fff"/></g></svg></span><span class="navbar-brand__name">Karpenter for Azure</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/docs"><i class='fas fa-book'></i><span>Docs</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="https://github.com/Azure/karpenter-provider-azure" target="_blank"><i class='fab fa-github'></i><span>GitHub</span></a>
      </li>
      <li class="nav-item dropdown mr-4 d-none d-lg-block">
        


	




<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	v1.5.5  (latest) 
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="navbarVersionSelector">
	
	<a class="dropdown-item" href='/v1.5.5//reference/settings/' data-docs-version="v1.5.5">
		v1.5.5  (latest) 
	</a>
	
</div>
</li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    
  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav foldable-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
  <a href="/docs/" title="Documentation" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">Docs</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsgetting-started-li">
  <input type="checkbox" id="m-docsgetting-started-check"/>
  <label for="m-docsgetting-started-check"><a href="/docs/getting-started/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsgetting-started"><span class="">Getting Started</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedquickstart-li">
  <input type="checkbox" id="m-docsgetting-startedquickstart-check"/>
  <label for="m-docsgetting-startedquickstart-check"><a href="/docs/getting-started/quickstart/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsgetting-startedquickstart"><span class="">Quickstart</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsconcepts-li">
  <input type="checkbox" id="m-docsconcepts-check"/>
  <label for="m-docsconcepts-check"><a href="/docs/concepts/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsconcepts"><span class="">Concepts</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsnodepools-li">
  <input type="checkbox" id="m-docsconceptsnodepools-check"/>
  <label for="m-docsconceptsnodepools-check"><a href="/docs/concepts/nodepools/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsconceptsnodepools"><span class="">NodePools</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsnodeclasses-li">
  <input type="checkbox" id="m-docsconceptsnodeclasses-check"/>
  <label for="m-docsconceptsnodeclasses-check"><a href="/docs/concepts/nodeclasses/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsconceptsnodeclasses"><span class="">NodeClasses</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsscheduling-li">
  <input type="checkbox" id="m-docsconceptsscheduling-check"/>
  <label for="m-docsconceptsscheduling-check"><a href="/docs/concepts/scheduling/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsconceptsscheduling"><span class="">Scheduling</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsdisruption-li">
  <input type="checkbox" id="m-docsconceptsdisruption-check"/>
  <label for="m-docsconceptsdisruption-check"><a href="/docs/concepts/disruption/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsconceptsdisruption"><span class="">Disruption</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconceptsnap-vs-self-hosted-li">
  <input type="checkbox" id="m-docsconceptsnap-vs-self-hosted-check"/>
  <label for="m-docsconceptsnap-vs-self-hosted-check"><a href="/docs/concepts/nap-vs-self-hosted/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsconceptsnap-vs-self-hosted"><span class="">NAP vs Self-Hosted</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsreference-li">
  <input type="checkbox" id="m-docsreference-check" checked/>
  <label for="m-docsreference-check"><a href="/docs/reference/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsreference"><span class="">Reference</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsreferencesettings-li">
  <input type="checkbox" id="m-docsreferencesettings-check" checked/>
  <label for="m-docsreferencesettings-check"><a href="/docs/reference/settings/" class="align-left pl-0  active td-sidebar-link td-sidebar-link__page" id="m-docsreferencesettings"><span class="td-sidebar-nav-active-item">Settings</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsreferencecustom-networking-li">
  <input type="checkbox" id="m-docsreferencecustom-networking-check"/>
  <label for="m-docsreferencecustom-networking-check"><a href="/docs/reference/custom-networking/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsreferencecustom-networking"><span class="">Custom Networking</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsreferenceinstance-types-li">
  <input type="checkbox" id="m-docsreferenceinstance-types-check"/>
  <label for="m-docsreferenceinstance-types-check"><a href="/docs/reference/instance-types/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsreferenceinstance-types"><span class="">Instance Types</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsreferencenodepool-examples-li">
  <input type="checkbox" id="m-docsreferencenodepool-examples-check"/>
  <label for="m-docsreferencenodepool-examples-check"><a href="/docs/reference/nodepool-examples/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsreferencenodepool-examples"><span class="">NodePool Examples</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsreferencenodepools-li">
  <input type="checkbox" id="m-docsreferencenodepools-check"/>
  <label for="m-docsreferencenodepools-check"><a href="/docs/reference/nodepools/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsreferencenodepools"><span class=""></span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsfaq-li">
  <input type="checkbox" id="m-docsfaq-check"/>
  <label for="m-docsfaq-check"><a href="/docs/faq/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsfaq"><span class="">FAQ</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docstroubleshooting-li">
  <input type="checkbox" id="m-docstroubleshooting-check"/>
  <label for="m-docstroubleshooting-check"><a href="/docs/troubleshooting/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docstroubleshooting"><span class="">Troubleshooting</span></a></label>
  
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href="https://github.com/Azure/karpenter-provider-azure/tree/main/website/content/en/docs/reference/settings.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
  <a href="https://github.com/Azure/karpenter-provider-azure/edit/main/website/content/en/docs/reference/settings.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  <a href="https://github.com/Azure/karpenter-provider-azure/new/main/website/content/en/docs/reference/settings.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
  <a href="https://github.com/Azure/karpenter-provider-azure/issues/new?title=Settings" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
  
</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#feature-gates">Feature Gates</a></li>
        <li><a href="#batching-parameters">Batching Parameters</a></li>
        <li><a href="#azure-specific-configuration">Azure-Specific Configuration</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="//localhost:1313/docs/">Docs</a>
  </li>
  <li class="breadcrumb-item">
    <a href="//localhost:1313/docs/reference/">Reference</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="//localhost:1313/docs/reference/settings/" aria-disabled="true" class="btn-link disabled">Settings</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Settings</h1>
	<div class="lead">Configure Karpenter</div>
	<header class="article-meta">
		

  

		
	</header>    
	<p>Karpenter surfaces environment variables and CLI parameters to allow you to configure certain global settings on the controllers. These settings are described below.</p>
<table>
  <thead>
      <tr>
          <th>Environment Variable</th>
          <th>CLI Flag</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>BATCH_IDLE_DURATION</td>
          <td>--batch-idle-duration</td>
          <td>The maximum amount of time with no new pending pods that if exceeded ends the current batching window. If pods arrive faster than this time, the batching window will be extended up to the maxDuration. If they arrive slower, the pods will be batched separately. (default = 1s)</td>
      </tr>
      <tr>
          <td>BATCH_MAX_DURATION</td>
          <td>--batch-max-duration</td>
          <td>The maximum length of a batch window. The longer this is, the more pods we can consider for provisioning at one time which usually results in fewer but larger nodes. (default = 10s)</td>
      </tr>
      <tr>
          <td>CLUSTER_CA_BUNDLE</td>
          <td>--cluster-ca-bundle</td>
          <td>Cluster CA bundle for nodes to use for TLS connections with the API server. If not set, this is taken from the controller&rsquo;s TLS configuration.</td>
      </tr>
      <tr>
          <td>CLUSTER_ENDPOINT</td>
          <td>--cluster-endpoint</td>
          <td>[REQUIRED] The external kubernetes cluster endpoint for new nodes to connect with.</td>
      </tr>
      <tr>
          <td>CLUSTER_NAME</td>
          <td>--cluster-name</td>
          <td>[REQUIRED] The kubernetes cluster name for resource tags.</td>
      </tr>
      <tr>
          <td>DISABLE_WEBHOOK</td>
          <td>--disable-webhook</td>
          <td>Disable the admission and validation webhooks</td>
      </tr>
      <tr>
          <td>ENABLE_PROFILING</td>
          <td>--enable-profiling</td>
          <td>Enable the profiling on the metric endpoint</td>
      </tr>
      <tr>
          <td>FEATURE_GATES</td>
          <td>--feature-gates</td>
          <td>Optional features can be enabled / disabled using feature gates. Current options are: Drift,SpotToSpotConsolidation (default = Drift=true,SpotToSpotConsolidation=false)</td>
      </tr>
      <tr>
          <td>HEALTH_PROBE_PORT</td>
          <td>--health-probe-port</td>
          <td>The port the health probe endpoint binds to for reporting controller health (default = 8081)</td>
      </tr>
      <tr>
          <td>KARPENTER_SERVICE</td>
          <td>--karpenter-service</td>
          <td>The Karpenter Service name for the dynamic webhook certificate</td>
      </tr>
      <tr>
          <td>KUBE_CLIENT_BURST</td>
          <td>--kube-client-burst</td>
          <td>The maximum allowed burst of queries to the kube-apiserver (default = 300)</td>
      </tr>
      <tr>
          <td>KUBE_CLIENT_QPS</td>
          <td>--kube-client-qps</td>
          <td>The smoothed rate of qps to kube-apiserver (default = 200)</td>
      </tr>
      <tr>
          <td>KUBELET_BOOTSTRAP_TOKEN</td>
          <td>--kubelet-bootstrap-token</td>
          <td>[REQUIRED] The bootstrap token for new nodes to join the cluster.</td>
      </tr>
      <tr>
          <td>KUBELET_IDENTITY_CLIENT_ID</td>
          <td>--kubelet-identity-client-id</td>
          <td>The client ID of the kubelet identity.</td>
      </tr>
      <tr>
          <td>LEADER_ELECT</td>
          <td>--leader-elect</td>
          <td>Start leader election client and gain leadership before executing the main loop. Enable this when running replicated components for high availability.</td>
      </tr>
      <tr>
          <td>LINUX_ADMIN_USERNAME</td>
          <td>--linux-admin-username</td>
          <td>The admin username for Linux VMs. (default = azureuser)</td>
      </tr>
      <tr>
          <td>LOG_LEVEL</td>
          <td>--log-level</td>
          <td>Log verbosity level. Can be one of &lsquo;debug&rsquo;, &lsquo;info&rsquo;, or &rsquo;error&rsquo; (default = info)</td>
      </tr>
      <tr>
          <td>MEMORY_LIMIT</td>
          <td>--memory-limit</td>
          <td>Memory limit on the container running the controller. The GC soft memory limit is set to 90% of this value. (default = -1)</td>
      </tr>
      <tr>
          <td>METRICS_PORT</td>
          <td>--metrics-port</td>
          <td>The port the metric endpoint binds to for operating metrics about the controller itself (default = 8000)</td>
      </tr>
      <tr>
          <td>NETWORK_DATAPLANE</td>
          <td>--network-dataplane</td>
          <td>The network dataplane used by the cluster. (default = cilium)</td>
      </tr>
      <tr>
          <td>NETWORK_PLUGIN</td>
          <td>--network-plugin</td>
          <td>The network plugin used by the cluster. (default = azure)</td>
      </tr>
      <tr>
          <td>NETWORK_PLUGIN_MODE</td>
          <td>--network-plugin-mode</td>
          <td>Network plugin mode of the cluster. (default = overlay)</td>
      </tr>
      <tr>
          <td>NETWORK_POLICY</td>
          <td>--network-policy</td>
          <td>The network policy used by the cluster.</td>
      </tr>
      <tr>
          <td>NODEBOOTSTRAPPING_SERVER_URL</td>
          <td>--nodebootstrapping-server-url</td>
          <td>[UNSUPPORTED] The url for the node bootstrapping provider server.</td>
      </tr>
      <tr>
          <td>NODE_IDENTITIES</td>
          <td>--node-identities</td>
          <td>User assigned identities for nodes.</td>
      </tr>
      <tr>
          <td>AZURE_NODE_RESOURCE_GROUP</td>
          <td>--node-resource-group</td>
          <td>[REQUIRED] The resource group created and managed by AKS where the nodes live</td>
      </tr>
      <tr>
          <td>PROVISION_MODE</td>
          <td>--provision-mode</td>
          <td>[UNSUPPORTED] The provision mode for the cluster. (default = AKS-scriptless)</td>
      </tr>
      <tr>
          <td>SIG_ACCESS_TOKEN_SCOPE</td>
          <td>--sig-access-token-scope</td>
          <td>The scope for the SIG access token. Only used for AKS managed karpenter. UseSIG must be set to true for this to take effect.</td>
      </tr>
      <tr>
          <td>SIG_ACCESS_TOKEN_SERVER_URL</td>
          <td>--sig-access-token-server-url</td>
          <td>The URL for the SIG access token server. Only used for AKS managed karpenter. UseSIG must be set to true for this to take effect.</td>
      </tr>
      <tr>
          <td>SIG_SUBSCRIPTION_ID</td>
          <td>--sig-subscription-id</td>
          <td>The subscription ID of the shared image gallery.</td>
      </tr>
      <tr>
          <td>SSH_PUBLIC_KEY</td>
          <td>--ssh-public-key</td>
          <td>[REQUIRED] VM SSH public key.</td>
      </tr>
      <tr>
          <td>USE_SIG</td>
          <td>--use-sig</td>
          <td>If set to true karpenter will use the AKS managed shared image galleries and the node image versions api. If set to false karpenter will use community image galleries. Only a subset of image features will be available in the community image galleries and this flag is only for the managed node provisioning addon. (default = false)</td>
      </tr>
      <tr>
          <td>VNET_GUID</td>
          <td>--vnet-guid</td>
          <td>The vnet guid of the clusters vnet, only required by azure cni with overlay + byo vnet</td>
      </tr>
      <tr>
          <td>VNET_SUBNET_ID</td>
          <td>--vnet-subnet-id</td>
          <td>[REQUIRED] The default subnet ID to use for new nodes. This must be a valid ARM resource ID for subnet that does not overlap with the service CIDR or the pod CIDR.</td>
      </tr>
      <tr>
          <td>VM_MEMORY_OVERHEAD_PERCENT</td>
          <td>--vm-memory-overhead-percent</td>
          <td>The VM memory overhead as a percent that will be subtracted from the total memory for all instance types. (default = 0.075)</td>
      </tr>
      <tr>
          <td>WEBHOOK_METRICS_PORT</td>
          <td>--webhook-metrics-port</td>
          <td>The port the webhook metric endpoint binds to for operating metrics about the webhook (default = 8001)</td>
      </tr>
      <tr>
          <td>WEBHOOK_PORT</td>
          <td>--webhook-port</td>
          <td>The port the webhook endpoint binds to for validation and mutation of resources (default = 8443)</td>
      </tr>
  </tbody>
</table>
<h3 id="feature-gates">Feature Gates</h3>
<p>Karpenter uses <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/#feature-gates-for-alpha-or-beta-features">feature gates</a> You can enable the feature gates through the <code>--feature-gates</code> CLI environment variable or the <code>FEATURE_GATES</code> environment variable in the Karpenter deployment. For example, you can configure drift, spotToSpotConsolidation by setting the CLI argument: <code>--feature-gates Drift=true,SpotToSpotConsolidation=true</code>.</p>
<table>
  <thead>
      <tr>
          <th>Feature</th>
          <th>Default</th>
          <th>Stage</th>
          <th>Since</th>
          <th>Until</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Drift</td>
          <td>false</td>
          <td>Alpha</td>
          <td>v0.21.x</td>
          <td>v0.32.x</td>
      </tr>
      <tr>
          <td>Drift</td>
          <td>true</td>
          <td>Beta</td>
          <td>v0.33.x</td>
          <td></td>
      </tr>
      <tr>
          <td>SpotToSpotConsolidation</td>
          <td>false</td>
          <td>Beta</td>
          <td>v0.34.x</td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="batching-parameters">Batching Parameters</h3>
<p>The batching parameters control how Karpenter batches an incoming stream of pending pods.  Reducing these values may trade off a slightly faster time from pending pod to node launch, in exchange for launching smaller nodes.  Increasing the values can do the inverse.  Karpenter provides reasonable defaults for these values, but if you have specific knowledge about your workloads you can tweak these parameters to match the expected rate of incoming pods.</p>
<p>For a standard deployment scale-up, the pods arrive at the QPS setting of the <code>kube-controller-manager</code>, and the default values are typically fine.  These settings are intended for use cases where other systems may create large numbers of pods over a period of many seconds or minutes and there is a desire to batch them together.</p>
<h4 id="batch-idle-duration">Batch Idle Duration</h4>
<p>The batch idle duration duration is the period of time that a new pending pod extends the current batching window. This can be increased to handle scenarios where pods arrive slower than one second part, but it would be preferable if they were batched together onto a single larger node.</p>
<p>This value is expressed as a string value like <code>10s</code>, <code>1m</code> or <code>2h45m</code>. The valid time units are <code>ns</code>, <code>us</code> (or <code>µs</code>), <code>ms</code>, <code>s</code>, <code>m</code>, <code>h</code>.</p>
<h4 id="batch-max-duration">Batch Max Duration</h4>
<p>The batch max duration is the maximum period of time a batching window can be extended to. Increasing this value will allow the maximum batch window size to increase to collect more pending pods into a single batch at the expense of a longer delay from when the first pending pod was created.</p>
<p>This value is expressed as a string value like <code>10s</code>, <code>1m</code> or <code>2h45m</code>. The valid time units are <code>ns</code>, <code>us</code> (or <code>µs</code>), <code>ms</code>, <code>s</code>, <code>m</code>, <code>h</code>.</p>
<h3 id="azure-specific-configuration">Azure-Specific Configuration</h3>
<h4 id="authentication">Authentication</h4>
<p>Karpenter for Azure supports Azure Managed Identity and Service Principal authentication. The kubelet identity client ID is used for node authentication with Azure APIs.</p>
<h4 id="cluster-configuration">Cluster Configuration</h4>
<p>Required cluster settings include:</p>
<ul>
<li><strong>CLUSTER_NAME</strong>: The AKS cluster name for resource tagging</li>
<li><strong>CLUSTER_ENDPOINT</strong>: The Kubernetes API server endpoint</li>
<li><strong>AZURE_NODE_RESOURCE_GROUP</strong>: The MC_ resource group where VMs are created</li>
</ul>
<h4 id="networking">Networking</h4>
<p>Network configuration options:</p>
<ul>
<li><strong>VNET_SUBNET_ID</strong>: Required subnet ID for node network interfaces</li>
<li><strong>VNET_GUID</strong>: VNet GUID for Azure CNI with overlay + BYO VNet scenarios</li>
<li><strong>NETWORK_PLUGIN</strong>: Network plugin (default: azure)</li>
<li><strong>NETWORK_PLUGIN_MODE</strong>: Network plugin mode (default: overlay)</li>
<li><strong>NETWORK_DATAPLANE</strong>: Network dataplane (default: cilium)</li>
<li><strong>NETWORK_POLICY</strong>: Optional network policy configuration</li>
</ul>
<h4 id="node-configuration">Node Configuration</h4>
<p>Node-specific settings:</p>
<ul>
<li><strong>SSH_PUBLIC_KEY</strong>: Required SSH public key for VM access</li>
<li><strong>LINUX_ADMIN_USERNAME</strong>: Admin username for Linux VMs (default: azureuser)</li>
<li><strong>NODE_IDENTITIES</strong>: Comma-separated list of user-assigned identities</li>
<li><strong>KUBELET_BOOTSTRAP_TOKEN</strong>: Required bootstrap token for cluster joining</li>
</ul>
<h4 id="image-management">Image Management</h4>
<p>For managed Karpenter instances (NAP):</p>
<ul>
<li><strong>USE_SIG</strong>: Enable AKS managed shared image galleries (default: false)</li>
<li><strong>SIG_SUBSCRIPTION_ID</strong>: Subscription ID for shared image gallery</li>
<li><strong>SIG_ACCESS_TOKEN_SERVER_URL</strong>: Token server URL for SIG access</li>
<li><strong>SIG_ACCESS_TOKEN_SCOPE</strong>: Token scope for SIG access</li>
</ul>

	
	
	
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
          
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
          
            
  <ul class="list-inline mb-0">
    
      <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
        <a class="text-white" target="_blank" rel="noopener" href="https://github.com/Azure/karpenter-provider-azure" aria-label="GitHub">
          <i class="fab fa-github"></i>
        </a>
      </li>
    
      <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
        <a class="text-white" target="_blank" rel="noopener" href="https://slack.k8s.io/" aria-label="Slack">
          <i class="fab fa-slack"></i>
        </a>
      </li>
    
  </ul>

          
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2025 Microsoft Corporation or its affiliates. All Rights Reserved</small>
        
        
      </div>
    </div>
  </div>
</footer>


    </div>
    
  <script src="/js/main.js"></script>
<script src='/js/prism.js'></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>